from toee import *
import tpdp

def OnBeginSpellCast(spell):
	game.particles('sp-abjuration-conjure', spell.caster)

def OnSpellEffect(spell):
	# lessen
	duration = 600 * spell.caster_level
	spell.duration = duration
	immune_level = 4

	for target_item in spell.target_list:
		target = target_item.obj
		#key = tpdp.hash("GLOBE_OF_INVULNERABILITY")
#		target.condition_add_with_args(
#				'sp-Globe of Invulnerability', spell.id, duration, 0, 4, key)
		target_item.partsys_id = game.particles(
				'sp-Globe of Invulnerability', target)
